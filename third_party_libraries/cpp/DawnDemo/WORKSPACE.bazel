"""
    SPDX-FileCopyrightText: 2022 Julian Amann <dev@vertexwahn.de>
    SPDX-License-Identifier: Apache-2.0
"""

workspace(name = "de_vertexwahn_hello_dawn")

load("@bazel_tools//tools/build_defs/repo:git.bzl", "git_repository", "new_git_repository")
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

http_archive(
    name = "bazel_skylib",
    sha256 = "c6966ec828da198c5d9adbaa94c05e3a1c7f21bd012a0b29ba8ddbccb2c93b0d",
    urls = [
        "https://mirror.bazel.build/github.com/bazelbuild/bazel-skylib/releases/download/1.1.1/bazel-skylib-1.1.1.tar.gz",
        "https://github.com/bazelbuild/bazel-skylib/releases/download/1.1.1/bazel-skylib-1.1.1.tar.gz",
    ],
)

#--------------------------------------------------------------------------------------
# Python
#--------------------------------------------------------------------------------------

# https://github.com/bazelbuild/rules_python
http_archive(
    name = "rules_python",
    sha256 = "5fa3c738d33acca3b97622a13a741129f67ef43f5fdfcec63b29374cc0574c29",
    strip_prefix = "rules_python-0.9.0",
    urls = [
        "https://github.com/bazelbuild/rules_python/archive/refs/tags/0.9.0.tar.gz",
        "https://storage.googleapis.com/skia-world-readable/bazel/5fa3c738d33acca3b97622a13a741129f67ef43f5fdfcec63b29374cc0574c29.tar.gz",
    ],
)

# This sets up a hermetic python3, rather than depending on what is installed.
load("@rules_python//python:repositories.bzl", "python_register_toolchains")

python_register_toolchains(
    name = "python3_9",
    # https://github.com/bazelbuild/rules_python/blob/main/python/versions.bzl
    python_version = "3.9",
)

load("@python3_9//:defs.bzl", "interpreter")
load("@rules_python//python:pip.bzl", "pip_install")

pip_install(
    name = "py_deps",
    python_interpreter_target = interpreter,
    requirements = "//:requirements.txt",
)

#--------------------------------------------------------------------------------------
# Other
#--------------------------------------------------------------------------------------

git_repository(
    name = "abseil_cpp",
    commit = "c5a424a2a21005660b182516eb7a079cd8021699",
    remote = "https://github.com/abseil/abseil-cpp.git",
    shallow_since = "1646773276 -0500",
)

git_repository(
    name = "spirv_tools",
    commit = "eb113f0fdfff8efc114953bdabf1738db681ad8d",
    remote = "https://skia.googlesource.com/external/github.com/KhronosGroup/SPIRV-Tools.git",
    shallow_since = "1666277503 -0400",
)

new_git_repository(
    name = "vulkan_headers",
    shallow_since = "1665648471 -0700",
    build_file = "//bazel:vulkan_headers.BUILD",
    commit = "98f440ce6868c94f5ec6e198cc1adda4760e8849",
    remote = "https://chromium.googlesource.com/external/github.com/KhronosGroup/Vulkan-Headers.git",
    workspace_file_content = "",
)

new_git_repository(
    name = "vulkan_tools",
    build_file = "//bazel:vulkan_tools.BUILD",
    commit = "0a3b52945c40ecac86c09139b35e753912e5dbcf",
    remote = "https://chromium.googlesource.com/external/github.com/KhronosGroup/Vulkan-Tools",
    workspace_file_content = "",
    shallow_since = "1666304610 -0400",
)

git_repository(
    name = "spirv_headers",
    commit = "85a1ed200d50660786c1a88d9166e871123cce39",
    remote = "https://skia.googlesource.com/external/github.com/KhronosGroup/SPIRV-Headers.git",
    shallow_since = "1664985850 +0700",
)

new_git_repository(
    name = "dawn",
    build_file = "//bazel:dawn.BUILD",
    commit = "d32fbe07e76a37f0df143bbdd1fb1be70c29b93b",
    remote = "https://dawn.googlesource.com/dawn.git",
    shallow_since = "1666140221 +0000",
    workspace_file_content = "",
)

#-------------------------------------------------------------------------------------
# emsdk
#-------------------------------------------------------------------------------------

http_archive(
    name = "emsdk",
    sha256 = "67d68f4ed47aa0b97ab4d40b70a55f068455bb6e5821c6b04c7d6089b6495d20",
    strip_prefix = "emsdk-e41b8c68a248da5f18ebd03bd0420953945d52ff/bazel",
    url = "https://github.com/emscripten-core/emsdk/archive/e41b8c68a248da5f18ebd03bd0420953945d52ff.tar.gz",
)

load("@emsdk//:deps.bzl", emsdk_deps = "deps")
emsdk_deps()

load("@emsdk//:emscripten_deps.bzl", emsdk_emscripten_deps = "emscripten_deps")
emsdk_emscripten_deps(emscripten_version = "3.1.24")


#-------------------------------------------------------------------------------------
# Qt6
#-------------------------------------------------------------------------------------

git_repository(
    name = "de_vertexwahn_rules_qt6",
    commit = "b219cfb40322b9515356b8bcc9ea8394257c5b42",
    remote = "https://github.com/Vertexwahn/rules_qt6.git",
    shallow_since = "1666212839 +0200"
)

load("@de_vertexwahn_rules_qt6//:fetch_qt.bzl", "fetch_qt6")

fetch_qt6()

load("@de_vertexwahn_rules_qt6//tools:qt_toolchain.bzl", "register_qt_toolchains")

register_qt_toolchains()


#-------------------------------------------------------------------------------------
# Vulkan
#-------------------------------------------------------------------------------------

http_archive(
    name = "com_github_zaucy_rules_7zip",
    sha256 = "7adf6bcd53403ab9a44d8b42db0e8afe7fd547dbee21a5c6f5479966d96462a5",
    strip_prefix = "rules_7zip-7c9fb2b1bdab4d4c3fdd49b1e12d21a5b728dc57",
    url = "https://github.com/zaucy/rules_7zip/archive/7c9fb2b1bdab4d4c3fdd49b1e12d21a5b728dc57.zip",
)

load("@com_github_zaucy_rules_7zip//:setup.bzl", "setup_7zip")

setup_7zip()



http_archive(
    name = "com_github_zaucy_rules_vulkan",
    strip_prefix = "rules_vulkan-477a314b02a9e435c71436317fecf1a77d5a0492",
    url = "https://github.com/zaucy/rules_vulkan/archive/477a314b02a9e435c71436317fecf1a77d5a0492.zip",
    sha256 = "9adc924d1a9c4f19afce0cd63fdf2111b7ffdc4541b633d8316af152ef278604",
)

#http_archive(
#    name = "com_github_zaucy_rules_vulkan",
#    sha256 = "9adc924d1a9c4f19afce0cd63fdf2111b7ffdc4541b633d8316af152ef278604",

#    strip_prefix = "rules_vulkan-477a314b02a9e435c71436317fecf1a77d5a0492",
#    url = "https://github.com/zaucy/rules_vulkan/archive/477a314b02a9e435c71436317fecf1a77d5a0492.zip",
#)

load("@com_github_zaucy_rules_vulkan//:repo.bzl", "vulkan_repos")

vulkan_repos()